function pl_$(a){return document.getElementById("pl_"+a)}var pl_sampa={};window.onload=function(){function b(g,i){var h=document.getElementsByTagName("head")[0],f=document.createElement("script");f.type="text/javascript";f.src=g;f.onreadystatechange=i;f.onload=i;h.appendChild(f)}function a(){var k,h=lesson.length,g={de:"German",es:"Spanish",it:"Italian"};function j(l){var m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];l=new Date(l);return l.getDate()+" "+m[l.getMonth()]+" "+l.getFullYear()}function i(o){function n(u){return u instanceof Array?u:[u]}function m(u,v){u.play();if(v){u.onended=v}}function l(u){var v=0;function w(){if(v+1===u.length){m(u[v],null)}else{m(u[v],function(){v++;w()})}}if(u){w()}}function s(){function v(w){return[].slice.call(pl_$("definitions_"+w).getElementsByTagName("audio"))}var u;if(pl_$("l1").checked){u=v("l1")}if(c&&pl_$("l2").checked){if(u){u.concat(v("l2"))}else{u=v("l2")}}l(u)}function p(w,G,F){function A(J){var I="",K=["ogg","mp3"];for(var H=0;H<2;H++){I+='<source src="http://web.tiscali.it/insegnanteitaliano/audio/'+w+"/"+encodeURIComponent(J.replace(/\?/g,"Q"))+"."+K[H]+'" type="audio/'+K[H]+'" />'}return I}function D(H){var I=pl_$("definitions_"+H);I.style.display="block";l(I.getElementsByTagName("audio"))}function u(N,K){function M(O){return O.replace(/^[?!,.]+|[?!,.]+$/g,"")}var H="/",L=K.split(/\s+/);for(var J=0;J<L.length;J++){var I;if(typeof(I=pl_sampa[N][M(L[J])])=="undefined"){I="?"}if(H!="/"){H+=" "}H+=I}return H+"/"}var B,y,x=w==lk,E;switch(w){case lk:y="lk";break;case l1:y="l1";break;case l2:y="l2";break;default:console.warn("Undefined lesson language "+w);return}if(x){B='<dt lang="'+w+'"><ul>'}else{B='<dd lang="'+w+'">';if((E=pl_$(y).checked)&&F){B+='<textarea rows="2" cols="40" autofocus="" placeholder="speak your answer and optionally write it here in '+g[w]+' and then compare"></textarea><button id="pl_check_'+y+'">check</button><ul id="pl_definitions_'+y+'" style="display: none">';setTimeout(function(){pl_$("check_"+y).onclick=function(){D(y)}},0)}else{B+='<ul id="pl_definitions_'+y+'">'}}G=n(G);for(var z=0;z<G.length;z++){var C=G[z];B+="<li>";if(x){B+=C}else{var v=w+z;B+='<audio id="'+v+'"'+(E?' preload="auto"':' preload="none"')+">"+A(C)+"</audio><button onclick=\"pl_$('"+v+"').play()\" title='"+u(w,G[z])+"'>"+G[z]+"</button>"}B+="</li>"}B+="</ul>"+(x?"</dt>":"</dd>");return B}function r(u){var w="";if(u){u=n(u);for(var v=0;v<u.length;v++){w+="<p>"+u[v]+"</p>"}}return w}pl_$("step").value=k=+o;if(k==1){pl_$("first").disabled=true;pl_$("previous").disabled=true}else{pl_$("first").disabled=false;pl_$("previous").disabled=false}if(k==h){pl_$("next").disabled=true;pl_$("last").disabled=true}else{pl_$("next").disabled=false;pl_$("last").disabled=false}var q=lesson[k-1],t;switch(q[0]){case"tra":t=true;case"def":pl_$("translations").innerHTML="<dl>"+p(lk,q[1])+p(l1,q[2],t)+(c?p(l2,q[3],t):"")+"</dl>";if(!t){setTimeout(function(){s()},1*1000)}pl_$("comments").innerHTML=r(q[c?4:3]);break;case"com":pl_$("translations").innerHTML="";pl_$("comments").innerHTML=r(q[1]);break;default:console.warn("Unknown slide type "+q[0])}}pl_$("first").onclick=function(){i(1);return false};pl_$("previous").onclick=function(){i(k-1);return false};pl_$("step_form").onsubmit=function(){i(pl_$("step").value);return false};pl_$("step").onclick=function(){this.select()};pl_$("step").onblur=function(){if(this.value<1||this.value>h){this.value=k}};pl_$("next").onclick=function(){i(k+1);return false};pl_$("last").onclick=function(){i(h);return false};pl_$("l1").onchange=function(){i(k)};if(c){pl_$("l2").onchange=function(){i(k)}}pl_$("step").min=1;pl_$("step").max=pl_$("steps").textContent=h;pl_$("ll1").textContent=g[l1];if(c){var f=pl_$("idx");if(f){f.setAttribute("href",l1+".html");f.textContent=g[l1]+"-"+g[l2]+" chat index"}}if(c){pl_$("ll2").textContent=g[l2]}pl_$("title").textContent=title;pl_$("date").setAttribute("datetime",date);pl_$("date").textContent=j(date);i(1)}var d=location.pathname,e=d.lastIndexOf("/")+1,c;b(d.substr(e,d.lastIndexOf(".")-e)+"/"+location.search.substring(1)+".js",function(){b("sampa/"+l1+".js",function(){c=typeof l2!="undefined";if(c){b("sampa/"+l2+".js",a)}else{a()}})})};